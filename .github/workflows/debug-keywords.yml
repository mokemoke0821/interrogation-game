name: ğŸ” Debug Keyword Detection
on:
  issues:
    types: [opened, edited]
  issue_comment:
    types: [created, edited]

jobs:
  debug-keywords:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ” Debug Event Data
        run: |
          echo "ğŸ” Event Type: ${{ github.event_name }}"
          echo "ğŸ” Action: ${{ github.event.action }}"
          echo "ğŸ” Actor: ${{ github.actor }}"
          echo "ğŸ” Repository: ${{ github.repository }}"
          
      - name: ğŸ” Debug Issue Content
        if: github.event_name == 'issues'
        run: |
          echo "ğŸ“ Issue Title: ${{ github.event.issue.title }}"
          echo "ğŸ“ Issue Body:"
          echo "${{ github.event.issue.body }}"
          echo "ğŸ” Contains [claude-ai]: ${{ contains(github.event.issue.body, '[claude-ai]') }}"
          echo "ğŸ” Contains claude-help: ${{ contains(github.event.issue.body, 'claude-help') }}"
          
      - name: ğŸ” Debug Comment Content  
        if: github.event_name == 'issue_comment'
        run: |
          echo "ğŸ’¬ Comment Body:"
          echo "${{ github.event.comment.body }}"
          echo "ğŸ” Contains [claude-ai]: ${{ contains(github.event.comment.body, '[claude-ai]') }}"
          echo "ğŸ” Contains claude-help: ${{ contains(github.event.comment.body, 'claude-help') }}"
          
      - name: ğŸ¯ Keyword Detection Result
        if: contains(github.event.comment.body, '[claude-ai]') || contains(github.event.issue.body, '[claude-ai]') || contains(github.event.comment.body, 'claude-help') || contains(github.event.issue.body, 'claude-help')
        run: |
          echo "âœ… ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºæˆåŠŸï¼"
          echo "ğŸš€ MAXãƒ—ãƒ©ãƒ³çµ±åˆå‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™"
          
      - name: ğŸ“ Debug Response
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issueBody = context.payload.issue?.body || '';
            const commentBody = context.payload.comment?.body || '';
            
            const hasClaudeAI = issueBody.includes('[claude-ai]') || commentBody.includes('[claude-ai]');
            const hasClaudeHelp = issueBody.includes('claude-help') || commentBody.includes('claude-help');
            
            const comment = `ğŸ” **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºãƒ‡ãƒãƒƒã‚°çµæœ**
            
            **Event**: ${context.eventName}
            **Action**: ${context.payload.action}
            **Time**: ${new Date().toISOString()}
            
            **æ¤œå‡ºçµæœ**:
            - ğŸ” \`[claude-ai]\` æ¤œå‡º: ${hasClaudeAI ? 'âœ… YES' : 'âŒ NO'}
            - ğŸ” \`claude-help\` æ¤œå‡º: ${hasClaudeHelp ? 'âœ… YES' : 'âŒ NO'}
            
            **Content**:
            \`\`\`
            Issue Body: ${issueBody.substring(0, 200)}...
            Comment Body: ${commentBody.substring(0, 200)}...
            \`\`\`
            
            ${hasClaudeAI || hasClaudeHelp ? 'ğŸš€ **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºæˆåŠŸï¼MAXãƒ—ãƒ©ãƒ³çµ±åˆå‡¦ç†å®Ÿè¡Œä¸­...**' : 'âš ï¸ **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒæ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ**'}`;
            
            if (context.eventName === 'issues') {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                body: comment
              });
            } else if (context.eventName === 'issue_comment') {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                body: comment
              });
            } 